---
import BaseLayout from "@/layouts/BaseLayout.astro";
import { getCollection } from "astro:content";
import { slugify } from "@/lib/utils";
import { ArrowLeft, Tag } from "lucide-react";
import { Button } from "@/components/ui/button";

const posts = await getCollection("blog");
const uniqueTags = [...new Set(posts.flatMap((post) => post.data.tags || []))];
---

<BaseLayout title="Tags" description="Browse content by topics">
  <div class="container max-w-4xl mx-auto px-4 py-12 sm:py-20">
    <Button
      variant="ghost"
      asChild
      className="mb-8 pl-0 hover:bg-transparent hover:text-primary gap-2"
    >
      <a href="/blog">
        <ArrowLeft className="h-4 w-4" />
        Back to Blog
      </a>
    </Button>

    <div class="mb-12 space-y-4">
      <h1 class="text-3xl sm:text-4xl font-bold tracking-tight">Topics</h1>
      <p class="text-muted-foreground text-lg">
        Explore articles by your interests.
      </p>
    </div>

    <div class="flex flex-wrap gap-4">
      {
        uniqueTags.map((tag) => (
          <a
            href={`/tags/${slugify(tag)}`}
            class="flex items-center gap-2 px-4 py-3 rounded-xl border border-border/50 bg-card/50 hover:border-primary/50 hover:bg-primary/5 transition-all duration-300 group"
          >
            <Tag className="h-4 w-4 text-muted-foreground group-hover:text-primary transition-colors" />
            <span class="text-lg font-medium group-hover:text-primary transition-colors">
              {tag}
            </span>
            <span class="ml-2 bg-muted/50 px-2 py-0.5 rounded-md text-xs text-muted-foreground">
              {posts.filter((p) => p.data.tags?.includes(tag)).length}
            </span>
          </a>
        ))
      }
    </div>
  </div>
</BaseLayout>
